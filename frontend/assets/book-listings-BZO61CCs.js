import{r as d,u as C,h as A,g as B,i as w,A as E,p as o,b as m,j as e,a as T,I as F,L as h,y as x}from"./index-BekFzax6.js";import{n as S}from"./not-found-BKxoFFwC.js";const R=()=>{const[p,r]=d.useState(!1),[u,j]=d.useState([]),{token:c,logout:n,isLogin:g,userDetails:l}=C(),N=A(),{setTotalCartItemsHeader:f}=B(),{openLogin:_}=w();d.useEffect(()=>{E.init(),i();const s=()=>{console.log("refreshBooks event triggered"),i()};return document.addEventListener("refreshBooks",s),()=>{document.removeEventListener("refreshBooks",s)}},[]);const i=async()=>{r(!0);try{const s=(l==null?void 0:l.id)||null,t=await o(m.booksListing,{user_id:s},c,n);if(t.success&&Array.isArray(t.data)){const L=t.data.map(a=>({id:a.id,title:a.book_name||"",slug:a.slug||"",image:a.image||"/assets/img/book-card.png",price:a.price||0,offer_price:a.offer_price||null,is_cart:a.is_cart||0}));j(L)}}catch{}finally{r(!1)}},v=async s=>{if(!g){N("/login");return}r(!0);try{const t=await o(m.addToCart,{item_id:s,item_type:"book"},c,n);t.success&&(x.success(t.message),i(),f(t.total_cart_items))}catch(t){console.error(t)}finally{r(!1)}},y=async s=>{r(!0);try{const t=await o(m.addToCart,{item_id:s,item_type:"book"},c,n);t.success&&(x.success(t.message),i(),f(t.total_cart_items))}catch{}finally{r(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(T,{visible:p}),e.jsx("section",{children:e.jsx("div",{className:"listing-page-section",children:e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"listing-page-top",children:e.jsxs("div",{children:[e.jsx("h2",{className:"listing-heading",children:"Books"}),e.jsx("p",{className:"text",children:"Explore Our Wide Range Of Courses To Expand Your Skills"})]})}),!p&&u.length===0&&e.jsxs("div",{className:"text-center py-5",children:[e.jsx("img",{src:S,alt:"Not Found",className:"img-fluid mb-3",style:{maxWidth:200}}),e.jsx("div",{children:"No book available."})]}),e.jsx("div",{className:"row mb-4",children:u.map(s=>e.jsx("div",{className:"col-lg-4 col-md-6 mb-4","data-aos":"zoom-out-left",children:e.jsxs("div",{className:"book-card",children:[e.jsx("img",{src:`${F}${s.image}`,alt:s.title,className:"img-fluid"}),e.jsx(h,{to:`/book/${s.slug}`,className:"text-decoration-none",children:e.jsx("h3",{className:"book-title",children:s.title})}),e.jsxs("p",{className:"course-price",style:{fontSize:20},children:["₹",s.offer_price||s.price,s.price&&s.offer_price&&s.offer_price<s.price&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"mrp-price",children:["₹",s.price]}),e.jsxs("span",{className:"discount-price",children:[Math.round((s.price-s.offer_price)/s.price*100),"% off"]})]})]}),e.jsxs("div",{className:"test-series-btn-group",children:[e.jsx(h,{to:`/book/${s.slug}`,className:"btn course-action-btn-white w-100 mb-2",children:"Details"}),g?e.jsx("a",{onClick:t=>{t.preventDefault(),s!=null&&s.is_cart?y(s.id):v(s.id)},className:`btn ${s!=null&&s.is_cart?"course-action-btn-danger btn-danger":"course-action-btn-primary btn-primary"} w-100`,children:s!=null&&s.is_cart?"Remove from Cart":"Add to Cart"}):e.jsx("button",{className:"btn course-action-btn-primary w-100 btn-primary",onClick:_,children:"Add to Cart"})]})]})},s.id))})]})})})]})};export{R as default};
