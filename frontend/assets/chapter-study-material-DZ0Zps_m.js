import{h as X,r as a,u as Z,f as ee,p as te,b as se,j as e,a as ae,L as ne,I as oe}from"./index-Dj8vARCT.js";const re=()=>{const x=X(),[I,V]=a.useState(1),[R,b]=a.useState(!1),[E,T]=a.useState(0),[L,F]=a.useState(0),[n,M]=a.useState(null),[g,A]=a.useState([]),[y,Y]=a.useState([]),[$,j]=a.useState(!1),[f,v]=a.useState(!1),[d,N]=a.useState(null),[u,c]=a.useState(!1),[w,C]=a.useState(0),[S,D]=a.useState(0),l=a.useRef(null),m=a.useRef(null),{token:U,logout:z}=Z(),{id:k}=ee(),W=k?atob(k):"",q=t=>{l.current&&(l.current.setPlaybackRate(t),V(t))},B=()=>{var s,r;const t=document.querySelector(".modal-dialog");!document.fullscreenElement&&t?(s=t.requestFullscreen)==null||s.call(t).then(()=>b(!0)):document.fullscreenElement&&((r=document.exitFullscreen)==null||r.call(document).then(()=>b(!1)))};a.useEffect(()=>{const t=s=>s.preventDefault();return document.addEventListener("contextmenu",t),()=>document.removeEventListener("contextmenu",t)},[]),a.useEffect(()=>{G()},[]);const G=async()=>{j(!0);try{const t=await te(se.chapterStudyMaterial,{chapter_id:W},U,z),{success:s,course_pdf_count:r,course_video_count:o,course_pdf:i,course_video:p,chapterDetails:h}=t;s&&(T(r||0),F(o||0),A(i||[]),Y(p||[]),M(h))}catch(t){console.error("Error fetching course materials:",t)}finally{j(!1)}},P=t=>{try{const s=new URL(t);if(s.hostname==="youtu.be")return s.pathname.substring(1);if(s.hostname.includes("youtube.com"))return s.searchParams.get("v")}catch{return null}return null},H=t=>{const s=P(t);s&&(N(s),v(!0))},O=()=>{v(!1),N(null),c(!1),clearInterval(m.current),l.current&&(l.current.stopVideo(),l.current=null)};a.useEffect(()=>{if(f&&d)if(window.YT)t();else{const o=document.createElement("script");o.src="https://www.youtube.com/iframe_api",document.body.appendChild(o),o.onload=t}function t(){window.YT&&d&&(l.current=new window.YT.Player("custom-youtube-player",{height:"100%",width:"100%",videoId:d,playerVars:{autoplay:1,modestbranding:1,rel:0,fs:0,controls:0,disablekb:1,iv_load_policy:3},events:{onReady:s,onStateChange:r}}))}function s(o){o.target.playVideo(),c(!0),D(o.target.getDuration()),J()}function r(o){const i=o.data;i===window.YT.PlayerState.PLAYING&&c(!0),i===window.YT.PlayerState.PAUSED&&c(!1),i===window.YT.PlayerState.ENDED&&c(!1)}return()=>clearInterval(m.current)},[f,d]);const J=()=>{clearInterval(m.current),m.current=setInterval(()=>{l.current&&C(l.current.getCurrentTime())},500)},K=()=>{l.current&&(u?l.current.pauseVideo():l.current.playVideo(),c(!u))},Q=t=>{const s=parseFloat(t.target.value);l.current&&l.current.seekTo(s,!0),C(s)},_=t=>{const s=Math.floor(t/3600),r=Math.floor(t%3600/60),o=Math.floor(t%60),i=s>0?s.toString().padStart(2,"0")+":":"",p=r.toString().padStart(2,"0"),h=o.toString().padStart(2,"0");return`${i}${p}:${h}`};return e.jsxs("section",{children:[e.jsx(ae,{visible:$}),e.jsx("div",{className:"course-study-top",style:{padding:"70px 0 40px 0"},children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"course-study-top-align",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"mb-2",children:[n==null?void 0:n.course_name,"  / ",(n==null?void 0:n.subject_id)&&e.jsx(ne,{to:`/study-materials/${btoa(n.subject_id)}`,children:n==null?void 0:n.subject_name})]}),e.jsxs("h2",{className:"sub-heading mb-2",children:["Chapter: ",n==null?void 0:n.chapter_name," - Course"]}),e.jsxs("p",{className:"text mb-0 text-secondary",children:["Subject: ",n==null?void 0:n.subject_name]})]}),e.jsxs("button",{className:"back-to-dash-btn btn",onClick:()=>window.history.length>1?x(-1):x("/dashboard"),children:[e.jsx("i",{className:"fa-solid fa-house-chimney"})," Back"]})]})})}),e.jsx("div",{className:"course-study-page",children:e.jsxs("div",{className:"container",children:[e.jsxs("ul",{className:"courses-tabs course-study-tab bg-light mx-auto mb-4",id:"pills-tab",role:"tablist",children:[e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsxs("button",{className:"nav-link active",id:"Course-Video-tab","data-bs-toggle":"pill","data-bs-target":"#Course-Video",type:"button",role:"tab",children:["Video : ",L,"+"]})}),e.jsx("li",{className:"nav-item",role:"presentation",children:e.jsxs("button",{className:"nav-link",id:"Course-PDF-tab","data-bs-toggle":"pill","data-bs-target":"#Course-PDF",type:"button",role:"tab",children:["PDF : ",E,"+"]})})]}),e.jsxs("div",{className:"tab-content",id:"pills-tabContent",children:[e.jsx("div",{className:"tab-pane fade show active",id:"Course-Video",role:"tabpanel",children:e.jsxs("div",{className:"row",children:[y.length===0&&e.jsx("p",{children:"No videos available."}),y.map((t,s)=>{const r=t.video_url||"",o=P(r),i=o?`https://img.youtube.com/vi/${o}/hqdefault.jpg`:"";return e.jsx("div",{className:"col-md-4 mb-4",children:e.jsxs("div",{className:"card h-100 shadow-sm",style:{cursor:"pointer"},onClick:()=>H(r),children:[i&&e.jsx("img",{src:i,alt:t.title||"Video",className:"card-img-top",style:{height:"230px",objectFit:"cover"}}),e.jsxs("div",{className:"card-body",children:[e.jsx("h6",{className:"card-title",children:t.video_title||"Untitled Video"}),e.jsx("small",{className:"card-title",children:t.video_sub_title||""})]})]})},t.id||s)})]})}),e.jsx("div",{className:"tab-pane fade",id:"Course-PDF",role:"tabpanel",children:e.jsx("div",{className:"course-studylist-overflow",children:e.jsxs("div",{className:"course-study-cards-align",children:[g.length===0&&e.jsx("p",{children:"No PDFs available."}),g.map((t,s)=>e.jsxs("div",{className:"course-study-pdf-card",children:[e.jsxs("div",{className:"pdf-studycard-top",children:[e.jsx("i",{className:"fa-solid fa-file-pdf"}),e.jsx("h4",{className:"pdf-studycard-title",children:t.title})]}),e.jsxs("div",{className:"d-flex gap-3 align-items-center w-100 justify-content-between flex-wrap",children:[s%2===0&&e.jsx("span",{className:"pdf-read-badge",children:e.jsx("i",{className:"fa-regular fa-circle-check"})}),e.jsx("a",{href:`${oe}${t.pdf||t.file_path||""}`,target:"_blank",rel:"noopener noreferrer",className:"pdf-study-view-btn btn ms-auto",children:"View"})]})]},t.id||s))]})})}),f&&d&&e.jsx("div",{className:"modal fade show d-block",tabIndex:-1,role:"dialog",style:{background:"rgba(0,0,0,0.6)",zIndex:1050},children:e.jsx("div",{className:"modal-dialog modal-xl modal-dialog-centered",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Now Playing"}),e.jsx("button",{type:"button",className:"btn-close",onClick:O})]}),e.jsxs("div",{className:"modal-body",style:{position:"relative",paddingBottom:"56.25%",height:0,overflow:"hidden"},children:[e.jsx("div",{id:"custom-youtube-player",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:1}}),e.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"transparent",zIndex:2}}),e.jsxs("div",{style:{position:"absolute",bottom:"10px",left:"10px",right:"10px",display:"flex",gap:"10px",alignItems:"center",zIndex:3,background:"rgba(0, 0, 0, 0.5)",padding:"5px",borderRadius:"6px"},children:[e.jsx("button",{onClick:K,style:{background:u?"#ff0000":"#28a745",color:"#fff",border:"none",padding:"6px 12px",borderRadius:"4px"},children:u?e.jsx("i",{className:"fas fa-pause"}):e.jsx("i",{className:"fas fa-play"})}),e.jsx("span",{style:{color:"#fff",minWidth:"60px"},children:_(w)}),e.jsx("input",{type:"range",min:0,max:S,step:1,value:w,onChange:Q,style:{flex:1}}),e.jsx("span",{style:{color:"#fff",minWidth:"60px"},children:_(S)}),e.jsx("select",{value:I,onChange:t=>q(Number(t.target.value)),style:{background:"#fff",color:"#000",borderRadius:"4px",padding:"4px 8px"},children:[.25,.5,1,1.25,1.5,1.75,2].map(t=>e.jsxs("option",{value:t,children:[t,"x"]},t))}),e.jsx("button",{onClick:B,style:{background:"#007bff",color:"#fff",border:"none",padding:"6px 12px",borderRadius:"4px"},children:R?e.jsx("i",{className:"fas fa-compress"}):e.jsx("i",{className:"fas fa-expand"})})]})]})]})})})]})]})})]})};export{re as default};
