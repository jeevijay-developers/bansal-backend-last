import{r as t,j as s,u as X,i as Y,h as Z,f as S,p as f,b as j,y as r,a as D,I,L as $,W as F}from"./index-DucSLBkY.js";import{R as ss,C as es}from"./ResponsiveMover-CjlzDnqU.js";import{l as as}from"./script.esm-BJ5QgV6L.js";const cs=(m,d)=>(m==null?void 0:m.toLowerCase())==="free"||d===0?"Free":"Paid",os=({exams:m})=>{const[d,N]=t.useState("All"),n=m.map(c=>({...c,category:cs(c.test_type,c.price)})),e=d==="All"?n:n.filter(c=>c.category===d);return s.jsxs("div",{className:"test-series-price-tabs",children:[s.jsx("ul",{className:"courses-tabs mb-4",style:{background:"var(--background-light)"},children:["All","Free","Paid"].map(c=>s.jsx("li",{className:"nav-item",children:s.jsxs("button",{className:`nav-link ${d===c?"active":""}`,type:"button",onClick:()=>N(c),children:[c," Test (",c==="All"?m.length:n.filter(b=>b.category===c).length,")"]})},c))}),e.length===0?s.jsx("ul",{className:"test-series-price-nav-list",children:s.jsx("li",{className:"test-serieslist-card",children:s.jsx("div",{children:"No active exams found."})})}):s.jsx("ul",{className:"test-series-price-nav-list",children:e.map(c=>s.jsxs("li",{className:"test-serieslist-card",children:[s.jsxs("h4",{children:[c.test_name.toUpperCase()," (",c.test_type?c.test_type.charAt(0).toUpperCase()+c.test_type.slice(1):"N/A",")"]}),s.jsxs("div",{className:"tslc-footer-align",children:[s.jsxs("div",{className:"tslc-specific-tags",children:[s.jsxs("span",{children:[s.jsx("i",{className:"fa-regular fa-circle-question"})," ",c.total_active_questions??0," Questions"]}),s.jsxs("span",{children:[s.jsx("i",{className:"fa-regular fa-file-lines"})," ",c.marks??0," Marks"]}),s.jsxs("span",{children:[s.jsx("i",{className:"fa-regular fa-clock"})," ",c.duration_test??"N/A"," Minutes"]})]}),c.category==="Free"?s.jsx("button",{className:"btn secondary-btn green-start-btn",children:"Start Now"}):s.jsxs("button",{className:"btn secondary-btn",children:[s.jsx("i",{className:"fa-solid fa-lock"})," Unlock Now"]})]})]},c.id))})]})},rs=()=>{const[m,d]=t.useState(!1),[N,n]=t.useState(!1),[e,c]=t.useState(""),[b,O]=t.useState([]),[v,R]=t.useState([]),{token:h,logout:g,isLogin:_,userDetails:x}=X(),[U,V]=t.useState([]),[u,y]=t.useState(""),[C,w]=t.useState(!1),{openLogin:k}=Y(),A=Z(),{id:W}=S(),G=W;t.useEffect(()=>{T()},[]);const P=async a=>{await T(a),A(`/test-series/${a}`)},T=async a=>{n(!0);try{const o=a||G,l=await f(j.testSeriesDetail,{slug:o,user_id:(x==null?void 0:x.id)||0},h,g),{data:i}=l.data;c(i),R(i.otherTestSeries),O(i.exams)}catch(o){console.error("Error fetching test series:",o),r.error((o==null?void 0:o.message)||"Something went wrong!")}finally{n(!1)}},q=()=>{n(!0),f(j.couponList,{user_id:x==null?void 0:x.id,type:"test"},h,g).then(a=>{const{success:o,data:l}=a;o?V(l):r.error(l)}).catch(a=>console.log(a)).finally(()=>{n(!1)})},L=a=>{if(!a)return r.error("Please select coupon code!"),!1;n(!0),y(a);const o={coupon_for:"test",coupon_code:a,course_id:e==null?void 0:e.id};f(j.applyCouponApi,o,h,g).then(l=>{const{status:i,message:p}=l;if(i){const{real_amount:E,discount_amount:H,gst_amount:z,total_amount:K,message:Q}=l;c(J=>({...J,offer_price:E,discount_amount:H,gst_amount:z,total_amount:K})),d(!1),r.success(Q),w(!1)}else r.error(p)}).catch(l=>console.log(l)).finally(()=>{n(!1)})},B=()=>{if(!u){r.error("No coupon to remove!");return}n(!0);const a={coupon_for:"test",coupon_code:u,course_id:e==null?void 0:e.id,remove:1};f(j.applyCouponApi,a,h,g).then(o=>{const{status:l,message:i}=o;l?(c(p=>({...p,offer_price:e==null?void 0:e.price,discount_amount:0,gst_amount:0,total_amount:e==null?void 0:e.price})),r.success("Coupon removed successfully"),y(""),w(!0)):r.error(i||"Failed to remove coupon")}).catch(o=>console.error(o)).finally(()=>{n(!1)})},M=async()=>{if(!_)return k();if(n(!0),(e==null?void 0:e.total_amount)===0){let a;u?a="coupon-transaction":a="free-course-transaction";const o={order_type:"test",course_id:e==null?void 0:e.id,transaction_id:a,payment_type:"online",payment_status:"complete",coupon_code:u};f(j.buyCourse,o,h,g).then(l=>{const{success:i,message:p}=l;i===!0?A("/dashboard"):r.error(p)}).catch(l=>console.log(l)).finally(()=>{n(!1)});return}try{const a={order_type:"test",course_id:e==null?void 0:e.id,payment_type:"online",payment_status:"complete",coupon_code:u,amount:e==null?void 0:e.total_amount,success_url:`${F}/dashboard/my-test-series`,failure_url:`${F}/test-series/${e==null?void 0:e.slug}`},o=await f(j.createTestSeriesCashFreeOrder,a,h,g),{success:l,payment_session_id:i,message:p}=o;if(!l){r.error(p||"Failed to create order");return}l&&(await as({mode:"production"})).checkout({paymentSessionId:i,redirectTarget:"_self"})}catch(a){console.error(a),r.error("An error occurred while creating order")}finally{n(!1)}};return s.jsxs(s.Fragment,{children:[s.jsx("style",{children:`
      .teachers-team-card img {
        object-fit: fill;
            aspect-ratio: 1 / 1.2;
      }
.course-details-left-section table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 15px;
}

.course-details-left-section table th,
.course-details-left-section table td {
  border: 1px solid #ddd;
  padding: 8px;
  text-align: left;
}

.course-details-left-section table th {
  background-color: #f5f5f5;
  font-weight: bold;
}

.course-details-left-section table tr:nth-child(even) {
  background-color: #f9f9f9;
}

.course-details-left-section table tr:hover {
  background-color: #f1f1f1;
}

    `}),s.jsx(D,{visible:N}),s.jsx(ss,{}),s.jsxs("div",{children:[s.jsx("div",{className:"course-details-page pb-0 testseries-details-page",children:s.jsx("div",{className:"container",children:s.jsxs("div",{className:"row justify-content-between",children:[s.jsx("div",{className:"col-lg-7 col-xxl-8 mb-4",children:s.jsxs("div",{className:"course-details-left-section",children:[s.jsxs("div",{className:"row",children:[s.jsxs("div",{className:"col-lg-12 col-md-6 mb-4 mb-lg-0",children:[s.jsx("div",{className:"details-top-badge test-detail-badge",children:s.jsxs("span",{className:"corse-cate-badge",children:["Category: ",e==null?void 0:e.category_name," "]})}),s.jsxs("h1",{className:"course-detail-heading testseries-details-heading",children:[s.jsx("img",{src:e!=null&&e.image?`${I}${e==null?void 0:e.details_image}`:"/assets/img/no_image.jpg",alt:"#",className:"img-fluid"})," ",e==null?void 0:e.name]})]}),s.jsx("div",{className:"col-lg-12 col-md-6 mb-4 mb-lg-0",children:s.jsx("div",{className:"course-card-details-move"})})]}),s.jsxs("div",{className:"course-details-content-card",id:"Details",children:[s.jsx("h2",{className:"sub-heading",children:"Know Details Test"}),s.jsx("p",{className:"course-details-context",dangerouslySetInnerHTML:{__html:e==null?void 0:e.description}})]})]})}),s.jsx("div",{className:"col-lg-5 col-xxl-4 mb-4",children:s.jsx("div",{className:"course-card-details-movers",children:s.jsxs("div",{className:"course-details-right-card",children:[s.jsxs("p",{className:"course-price details-page-price",children:[s.jsxs("span",{className:"mrp-price",children:["₹ ",e==null?void 0:e.price]}),"₹",e==null?void 0:e.offer_price]}),s.jsxs("div",{className:"course-cart-detail-card",children:[s.jsx("h4",{children:"Payment Details"}),s.jsx("table",{children:s.jsxs("tbody",{children:[s.jsxs("tr",{children:[s.jsx("td",{className:"text",children:"Price"}),s.jsxs("td",{className:"text-end",children:["₹ ",e==null?void 0:e.offer_price]})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"text",children:"Discount "}),s.jsxs("td",{className:"text-primery text-end",children:["- ₹ ",e==null?void 0:e.discount_amount]})]}),s.jsxs("tr",{children:[s.jsx("th",{className:"text",children:"Total Payable Amount"}),s.jsxs("th",{className:"text-end",children:["₹ ",e==null?void 0:e.total_amount]})]})]})}),s.jsx("div",{className:"cart-action-btn",children:e!=null&&e.is_paid?s.jsx("a",{className:"pay-now-btn btn",onClick:a=>a.preventDefault(),children:"Already Paid"}):(e==null?void 0:e.total_amount)===0?s.jsx("a",{onClick:M,className:"pay-now-btn btn",children:"Enroll Now"}):s.jsxs("a",{onClick:M,className:"pay-now-btn btn",children:["Pay Now ₹"," ",(((e==null?void 0:e.total_amount)||0)-((e==null?void 0:e.gst_amount)||0)).toFixed(2)]})}),s.jsxs("div",{className:"apply-coupon-card-input",children:[s.jsxs("div",{className:"apply-coupon-inputs-align",children:[s.jsx("img",{src:"/assets/img/discount.svg",alt:"Discount Icon",className:"img-fluid"}),s.jsx("input",{value:u,type:"text",placeholder:"Enter Coupon Code",className:"form-control",onChange:a=>y(a.target.value),disabled:!C}),u&&!C?s.jsxs("button",{type:"button",className:"remove-coupon-btn",onClick:B,children:[s.jsx("i",{className:"fa fa-times"})," "]}):s.jsx("button",{type:"button",className:"apply-coupon-btn",onClick:()=>L(u),children:"Apply"})]}),s.jsxs("button",{onClick:()=>{_?(q(),d(!0)):k()},className:"prdt-modal-open",type:"button",children:["View Coupon Code"," ",s.jsx("i",{className:"fa-solid fa-angle-right"})]})]}),s.jsxs("div",{className:"course-right-footer-sec d-none d-lg-block",children:[s.jsxs("div",{className:"pay-throw-images",children:[s.jsx("img",{src:"/assets/img/Visa.png",alt:"#",className:"trans-img"}),s.jsx("img",{src:"/assets/img/Mastercard.png",alt:"#",className:"trans-img"}),s.jsx("img",{src:"/assets/img/PayPal.png",alt:"#",className:"trans-img"}),s.jsx("img",{src:"/assets/img/GooglePay.png",alt:"#",className:"trans-img"}),s.jsx("img",{src:"/assets/img/GooglePay-1.png",alt:"#",className:"trans-img"})]}),s.jsx("div",{className:"note-cart-items",children:s.jsx("p",{className:"text-center",children:"Safe and secure payment | 100% Authentic resources"})})]})]})]})})}),s.jsx("div",{className:"col-xl-12 mb-3 mx-auto",children:s.jsx(os,{exams:b})})]})})}),s.jsx(es,{show:m,onClose:()=>d(!1),onApply:L,coupons:U,loading:N})]}),s.jsx("section",{children:s.jsx("div",{className:"test-series-section",children:s.jsxs("div",{className:"container",children:[s.jsxs("div",{className:"d-flex align-itme-center justify-content-between gap-3 mb-4",children:[s.jsx("h2",{className:"heading",children:"Other Test Series"}),s.jsx($,{to:"/test-series",className:"btn secondary-btn",children:"View All"})]}),s.jsx("div",{className:"row",children:v&&v.map(a=>s.jsx("div",{className:"col-lg-4 col-md-6 mb-4",onClick:()=>P(a==null?void 0:a.slug),style:{cursor:"pointer"},children:s.jsxs("div",{className:"test-series-card",onClick:o=>o.stopPropagation(),children:[s.jsxs($,{to:`/test-series/${a==null?void 0:a.slug}`,className:"text-decoration-none text-dark d-block",onClick:o=>o.stopPropagation(),children:[s.jsxs("div",{className:"test-series-card-top",children:[s.jsx("img",{src:a!=null&&a.image?`${I}${a==null?void 0:a.image}`:"/assets/img/no_image.jpg",alt:a==null?void 0:a.name,className:"img-fluid"}),s.jsxs("p",{className:"test-series-card-badge",children:["₹",a!=null&&a.offer_price?a==null?void 0:a.offer_price:a==null?void 0:a.price]})]}),s.jsx("h3",{className:"test-series-card-title",children:a==null?void 0:a.name})]}),s.jsx("div",{className:"test-series-btn-group",children:s.jsx("button",{onClick:o=>{o.stopPropagation(),P(a==null?void 0:a.slug)},className:"btn course-action-btn-white",children:"View Details"})})]})},a.id))})]})})})]})};export{rs as default};
